<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Beta emulator</title>
    <script language="javascript" type="text/javascript" src="termlib/termlib.js"></script>
    <script language="javascript" type="text/javascript" src="CPU.js"></script>
    <script language="javascript" type="text/javascript" src="MMU.js"></script>
    <script language="javascript" type="text/javascript" src="sprintf.js"></script>
    <script language="javascript" type="text/javascript" src="tests/hello.js"></script>
    <script language="javascript" type="text/javascript" src="tests/lab8.js"></script>
    <script language="javascript" type="text/javascript" src="tests/litmus.js"></script>
    <link rel="stylesheet" type="text/css" href="termlib/term_styles.css" />
    <script language="javascript" type="text/javascript">
      var term;

      function openTerm() {
          term = new Terminal( {handler: termHandler, initHandler: initTerm} );
          term.charMode = true;
          term.open();

          MMU.load(litmus_rom);
          CPU.reset();
          CPU.run({timer: true,
                   write: function(ch){
                      if (ch == 10)
                        term.newLine();
                      else
                        term.type(String.fromCharCode(ch));
                      }
                   },
                   function() {
                     term.type("--- Program terminated ----");
                   });
      }

      function initTerm() {
        this.lock = false;
      }
      function termHandler() {
        var ch = this.inputChar;
        if (ch == 13) ch = 10;
        CPU.press_key(ch);
      }

    </script>
  </head>
  <body onload="openTerm();">
    <div id='termDiv'>
    </div>

    <!--
      <pre id='debugLog' style="face: mono; border: 1px solid black; width: 100%: padding: 2em">
      </pre>
      -->
  </body>
</html>